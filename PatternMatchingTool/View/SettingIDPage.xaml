<Page x:Class="PatternMatchingTool.View.SettingIDPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:PatternMatchingTool.View"
        xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
      xmlns:converters="clr-namespace:PatternMatchingTool.Converter"
      mc:Ignorable="d" 
      d:DesignHeight="700" d:DesignWidth="1110" 
      HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
      Title="SettingIDPage">

    <Page.Resources>
        <converters:BitmapSourceConverter x:Key="BitmapSourceConvert" />
        <converters:BoolToBrushConverter x:Key="BoolToBrushConvert" />
    </Page.Resources>
    
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="350"/>
        </Grid.ColumnDefinitions>

        <!-- 왼쪽: 버튼 + CogDisplay -->
        <Grid Grid.Column="0" Margin="5">
            <Grid.RowDefinitions>
                <!-- 버튼 -->
                <RowDefinition Height="Auto"/>
                <!-- CogDisplay -->
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <DockPanel Grid.Row="0" Margin="3" LastChildFill="False">
                <Button Content="Grab Image" TextBlock.FontSize="12" Height="35" Width="120" Margin="3" Background="Black" DockPanel.Dock="Left" Command="{Binding GrabImageCommand}" />
                <Button Content="Grab Camera" TextBlock.FontSize="12" Height="35" Width="120" Margin="3" Background="Black" DockPanel.Dock="Left" Command="{Binding GrabCameraCommand}"/>
                <Button Content="Load Image" TextBlock.FontSize="12" Height="35" Width="120" Margin="3" Background="Black" DockPanel.Dock="Left" Command="{Binding LoadImageCommand}"/>
                <Button Content="Test Run" TextBlock.FontSize="12" Height="35" Width="120" Margin="3" Background="Black" DockPanel.Dock="Right" Command="{Binding TestRunCommand}"/>
            </DockPanel>

            <Viewbox Grid.Row="1"
            Stretch="Uniform"
            ClipToBounds="True"
            Grid.RowSpan="2">
                <Grid>
                    <Image Name="CameraImage"
               Stretch="Uniform"
               Source="{Binding DisplayBitmap, Converter={StaticResource BitmapSourceConvert}}"/>
                    <Canvas IsHitTestVisible="False">
                        <Rectangle Stroke="Red" StrokeThickness="5"
                       Width="{Binding BarcodeRect.Width}"
                       Height="{Binding BarcodeRect.Height}"
                       Canvas.Left="{Binding BarcodeRect.X}"
                       Canvas.Top="{Binding BarcodeRect.Y}"/>
                    </Canvas>
                </Grid>
            </Viewbox>
        </Grid>
        <!-- 오른쪽: 패턴 설정 -->
        <StackPanel Grid.Column="1" Margin="5" Width="300">
            <DockPanel Margin="10" LastChildFill="False">
                <GroupBox Margin="5" Header="Harder" Foreground="White">
                    <ui:ToggleSwitch 
                    Margin="15"
                    Content="{Binding IsTryHarder}" 
                    DockPanel.Dock="Left"
                    Height="20" 
                    Width="130"
                    IsChecked="{Binding IsTryHarder, Mode=TwoWay}"/>
                </GroupBox>
            </DockPanel>
            <DockPanel Margin="10" LastChildFill="False">
                <GroupBox Margin="5" Header="Inverted" Foreground="White">
                    <ui:ToggleSwitch 
                    Margin="15"
                    Content="{Binding IsTryInverted}" 
                    DockPanel.Dock="Left"
                    Height="20" 
                    Width="130"
                    IsChecked="{Binding IsTryInverted, Mode=TwoWay}"/>
                </GroupBox>
            </DockPanel>
            <DockPanel Margin="10" LastChildFill="False">
                <GroupBox Margin="5" Header="AutoRotate" Foreground="White">
                    <ui:ToggleSwitch 
                    Margin="15"
                    Content="{Binding IsTryAutoRotae}" 
                    DockPanel.Dock="Left"
                    Height="20" 
                    Width="130"
                    IsChecked="{Binding IsTryAutoRotae, Mode=TwoWay}"/>
                </GroupBox>
            </DockPanel>
            <DockPanel Margin="10" LastChildFill="False">
                <GroupBox Margin="5" Header="DownScale" Foreground="White" Visibility="Hidden">
                    <ui:ToggleSwitch 
                    Margin="15"
                    Content="{Binding IsTryDownscale}" 
                    DockPanel.Dock="Left"
                    Height="20" 
                    Width="130"
                    IsChecked="{Binding IsTryDownscale, Mode=TwoWay}"/>
                </GroupBox>
            </DockPanel>
            <DockPanel Margin="10" LastChildFill="False">
                <GroupBox Margin="5" Header="Result" Foreground="White">
                    <TextBlock Width="130" Height="20" Margin="15" Text="{Binding BarcodeID}"/>
                </GroupBox>
            </DockPanel>
            <DockPanel Margin="10" LastChildFill="False">
                <Button Margin="5" Content="SAVE" Width="170" Height="40" Command="{Binding SaveIDParametersCommand}" />
            </DockPanel>
        </StackPanel>
    </Grid>
</Page>
